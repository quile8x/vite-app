var oe=Object.defineProperty,ne=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var z=(c,a,e)=>a in c?oe(c,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[a]=e,I=(c,a)=>{for(var e in a||(a={}))ae.call(a,e)&&z(c,e,a[e]);if(B)for(var e of B(a))ce.call(a,e)&&z(c,e,a[e]);return c},_=(c,a)=>ne(c,se(a));import{r as g,a as ie}from"./vendor.4e524bb7.js";import{c as re,a0 as le,a1 as Y,a2 as de,B as E,L as P,C as fe,A as ue,a as pe,e as G}from"./Global.f8efdb66.js";import{X as ge}from"./App.9e2d2e3f.js";import{b as me}from"./chunk-MTWSNRX5.13be4509.js";import{j as l,F as he,a as t}from"./main.a508a078.js";import{P as be}from"./reactjs-popup.esm.3948ab6e.js";import"./index.a60be5ed.js";(function(){try{var c=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},a=new Error().stack;a&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[a]="cd32b72d-1c9e-4007-d011-cc67de1d262f",c._sentryDebugIdIdentifier="sentry-dbid-cd32b72d-1c9e-4007-d011-cc67de1d262f")}catch{}})();const ye="2GajDLTC6y04qsYsoDRq9nGmWwK",Ce="48c62c6b3f82d2ecfa2cbe4c90f97037",we=`${ye}:${Ce}`,w="YourCollectible",j=re({host:"ipfs.infura.io",port:5001,protocol:"https",headers:{authorization:`Basic ${me.Buffer.from(we).toString("base64")}`}}),H=async c=>{const a=new TextDecoder;let e="";for await(const S of j.cat(c))e+=a.decode(S);return e},Ae=c=>{const a="https://stg-claimgiftapi.openlivenft.io",e=ge(),S=le(),L=Y(S),M=Y(S,e==null?void 0:e.signer),h=[],$=async()=>{G.get(`http://192.168.1.25:3002/wallet-contract/${e.account}`).then(n=>{const s=n.data,p=s.filter((r,d)=>(JSON.stringify(r),d===s.findIndex(f=>(console.log("obj=====",f.contractName),f.contractName===r.contractName))));console.log("transactionsX=======================",p),p.forEach((r,d)=>{r.contractName!=w&&(J(r.contractName),console.log("contract Name =========",r.contractName))})}).catch(n=>console.log(n))},J=async n=>{var d,f;let s=L[n];const r=(d=(await s.balanceOf(e.account)).toNumber())!=null?d:0;for(let i=0;i<r;i++)try{console.log("Getting token index",i);const o=await s.tokenOfOwnerByIndex((f=e.account)!=null?f:"",i);console.log("tokenId",o);const m=await s.tokenURI(o);console.log("tokenURI",m);const C=m.replace("https://ipfs.io/ipfs/","");console.log("ipfsHash",C);const F=await H(C);try{const u=JSON.parse(F);console.log("ipfsObject",u),h.push(I({id:o,uri:m,owner:e.account},u)),flagTokenURL=!1}catch(u){console.log(u),flagTokenURL=!1}}catch(o){console.log(o)}A(h)},{mainnetProvider:R,blockExplorer:W,tx:b}=c,y=L[w],x=M[w],k=de(y,{contractName:w,functionName:"balanceOf",functionArgs:[e.account]}),[q,A]=g.exports.useState([]),[X,Se]=g.exports.useState(!1),[N,K]=g.exports.useState({}),[Q,T]=g.exports.useState(!1),O=()=>T(!1),[xe,U]=g.exports.useState(0),[v,D]=g.exports.useState(!0);g.exports.useEffect(()=>{$(),(async()=>{var r,d,f;if(!k)return;var s=!0;const p=(d=(r=k[0])==null?void 0:r.toNumber())!=null?d:0;for(let i=0;i<p;i++)try{console.log("Getting token index",i);const o=await y.tokenOfOwnerByIndex((f=e.account)!=null?f:"",i);console.log("tokenId",o);const m=await y.tokenURI(o);console.log("tokenURI",m);const C=m.replace("https://ipfs.io/ipfs/","");console.log("ipfsHash",C);const F=await H(C);try{const u=JSON.parse(F);console.log("ipfsObject",u),h.push(I({id:o,uri:m,owner:e.account},u)),s=!1}catch(u){console.log(u),s=!1}}catch(o){console.log(o)}A(h),h.length==0&&e.account?(console.log("collectibleUpdate.length ============",h.length),U(i=>i+1),V()):(D(!1),U(i=>i+1))})()},[e.account,k]);const V=async()=>{v==!0&&(console.log("canClaim ==== 1111 ====",v),T(!0),D(!1))};setTimeout(()=>{console.log("canClaim ==== final ====",v)},5e3);const[Z,Ie]=g.exports.useState(0);ie.useState([]);const ee=async n=>{n.preventDefault();const s=n.target.elements.file.files[0];console.log(s);const r=`https://infura-ipfs.io/ipfs/${(await j.add(s)).path}`,d={description:n.target.elements.description.value,external_url:"https://austingriffith.com/portfolio/paintings/",image:r,name:n.target.elements.title.value,contract:{address:y.address},attributes:[{trait_type:"BackgroundColor",value:"blue"},{trait_type:"Eyes",value:"googly"},{trait_type:"Stamina",value:15}]},f={walletAddress:e.account,contractAddress:y.address,contractName:w};await G.post(`${a}/wallet-contract`,f),console.log("image",d);const i=await j.add(JSON.stringify(d));console.log("Uploaded Hash:",i),console.log("YourCollectibleWrite=========",x),await b(x.mintItem(e.account,i.path),o=>{console.log("\u{1F4E1} Transaction Update:",o),o&&(o.status==="confirmed"||o.status===1)&&(console.log(" \u{1F37E} Transaction "+o.hash+" finished!"),console.log(" \u26FD\uFE0F "+o.gasUsed+"/"+(o.gasLimit||o.gas)+" @ "+parseFloat(o.gasPrice)/1e9+" gwei"))})},te=async()=>{!b||!e.account||(b(x.claim("0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266","0x288ccFAF1A234910e7A744732c8f255a033492DD",1)),T(!1))};return l(he,{children:[t("div",{style:{width:200},children:t(be,{open:Q,closeOnDocumentClick:!0,onClose:O,className:"popup-content",children:l("div",{className:"modal",children:[t("a",{className:"close",onClick:O,style:{float:"right"},children:"\xD7"}),t("br",{}),t(E,{style:{float:"center"},disabled:X||Z>=mintJson.length-1,shape:"round",size:"large",onClick:async()=>{await te()},children:"Claim a gift!"})]})})}),l("div",{style:{width:640,margin:"auto",marginTop:32,paddingBottom:32},children:[t("h1",{children:"Mint NTF"}),l("form",{onSubmit:ee,children:[l("div",{style:{fontSize:16,marginLeft:8},children:[t("span",{style:{fontSize:16,marginLeft:8,float:"left"},children:" Title: "}),t("input",{name:"title",type:"text",class:"ant-input ant-input-lg"})]}),l("div",{style:{fontSize:16,marginLeft:8},children:[t("span",{style:{fontSize:16,marginLeft:8,float:"left"},children:" Description: "}),t("input",{name:"description",type:"text",class:"ant-input ant-input-lg"})]}),l("div",{style:{fontSize:16,marginLeft:8},children:[t("span",{style:{fontSize:16,marginLeft:8,float:"left"},children:" File:  "}),t("input",{name:"file",type:"file",class:"ant-input ant-input-lg"})]}),t("br",{}),t("div",{children:t("span",{style:{fontSize:16,marginLeft:8},children:t("button",{type:"submit",class:"ant-input ant-input-lg",children:" MINT"})})})]})]}),l("div",{style:{width:640,margin:"auto",marginTop:32,paddingBottom:32},children:[t("hr",{}),t("br",{}),t("h1",{children:"List NFTs"}),t("br",{}),t(P,{bordered:!0,dataSource:q,renderItem:n=>{const s=n.id.toNumber(),p=n.image;return console.log("item===========",n),console.log("id=============",s),l(P.Item,{children:[l(fe,{title:l("div",{children:[l("span",{style:{fontSize:16,marginRight:8},children:["#",s]})," ",n.name]}),children:[t("div",{children:t("img",{src:p,style:{maxWidth:150}})}),t("div",{children:n.description})]}),l("div",{children:["owner:"," ",t(ue,{address:n.owner,ensProvider:R,blockExplorer:W,fontSize:16}),t(pe,{ensProvider:R,placeholder:"transfer to address",address:N[s],onChange:r=>{K(_(I({},N),{[s]:r}))}}),t(E,{onClick:()=>{!e.account||!b||b(x.transferFrom(e.account,N[s],s))},children:"Transfer"})]})]},s+"_"+n.uri+"_"+n.owner)}})]})]})};export{Ae as YourCollectibles};
