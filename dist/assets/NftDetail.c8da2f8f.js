var re=Object.defineProperty,le=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var D=(r,n,s)=>n in r?re(r,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[n]=s,C=(r,n)=>{for(var s in n||(n={}))ce.call(n,s)&&D(r,s,n[s]);if(N)for(var s of N(n))de.call(n,s)&&D(r,s,n[s]);return r},A=(r,n)=>le(r,ie(n));import{r as a,a as fe}from"./vendor.4e524bb7.js";import{X as pe,W as ue}from"./App.9e2d2e3f.js";import{j as l,F as me,a as e}from"./main.a508a078.js";import{c as he,aK as T,e as w,M as ge,L as R,C as ye,A as be,a as xe,B as j,d as ve}from"./Global.f8efdb66.js";import{b as Ce}from"./chunk-MTWSNRX5.13be4509.js";import{P as we}from"./reactjs-popup.esm.3948ab6e.js";import{C as Se}from"./CM.f0743de6.js";import"./index.a60be5ed.js";(function(){try{var r=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},n=new Error().stack;n&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[n]="604d3958-dffe-4949-6c77-98f7ecb62855",r._sentryDebugIdIdentifier="sentry-dbid-604d3958-dffe-4949-6c77-98f7ecb62855")}catch{}})();const Ie="2GajDLTC6y04qsYsoDRq9nGmWwK",ke="48c62c6b3f82d2ecfa2cbe4c90f97037",Ne=`${Ie}:${ke}`,De="Contract One",Ae=he({host:"ipfs.infura.io",port:5001,protocol:"https",headers:{authorization:`Basic ${Ce.Buffer.from(Ne).toString("base64")}`}}),Te=async r=>{const n=new TextDecoder;let s="";for await(const u of Ae.cat(r))s+=n.decode(u);return s},Fe=r=>{const n="https://stg-claimgiftapi.openlivenft.io",s=pe(),{tokenID:u}=T(),{addressContract:E}=T(),h=[],[p,G]=a.exports.useState(void 0),[S,W]=a.exports.useState([]),[g,B]=a.exports.useState(void 0);let L=0;const[d,O]=a.exports.useState(void 0),[Re,$]=a.exports.useState(void 0),[q,P]=a.exports.useState(void 0),[je,_]=a.exports.useState(void 0),[Ee,M]=a.exports.useState(void 0);a.exports.useState(!1),a.exports.useState(!1);const[z,F]=a.exports.useState(!1),[I,U]=a.exports.useState(!1),Y={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",border:null}},[H,Ge]=fe.useState(!1);function K(){}const X=async()=>{M(void 0),_(void 0);const[o]=await window.ethereum.request({method:"eth_requestAccounts"});$(o);const t=new ue(window.ethereum),i=new ve(E,Se.abi,t.getSigner(0));O(i)},J=async()=>{if(!d)return;let o=await d.balanceOf(s.account);if(!o)return;const t=o.toNumber();P(t)};a.exports.useEffect(()=>{X()},[]),a.exports.useEffect(()=>{d&&J()},[d]);const{mainnetProvider:Q,blockExplorer:We,tx:y}=r,[V,Z]=a.exports.useState([]),[b,ee]=a.exports.useState({}),[te,x]=a.exports.useState(!1),v=()=>x(!1);a.exports.useEffect(()=>{ae(),(async()=>{if(!!d){try{let t=u-1;const i=await d.tokenByIndex(t);console.log("tokenId==============",i);const c=await d.tokenURI(i);console.log("tokenURI============",c);const f=c.replace("https://ipfs.io/ipfs/","");console.log("ipfsHash",f);const k=await Te(f);try{const m=JSON.parse(k);console.log("ipfsObject",m),h.push(C({id:i,uri:c,owner:s.account},m)),flagTokenURL=!1}catch(m){console.log(m),flagTokenURL=!1}}catch(t){console.log(t)}if(Z(h),h.length>0){let t=await oe(u);t!=I&&U(t)}}})()},[s.account,q,d,z]);const oe=async o=>{const t=await w.get(`${n}/gift-request/checkCanClaimGift/${s.account}/${d.address}/${o}`);return console.log("rep.data===========================",t.data),t.data},se=async o=>{var i,c;o.preventDefault(),console.log("claimedTokenID ======================",L);const t={name:o.target.elements.name.value,phone:o.target.elements.phone.value,contractName:De,contractAddress:d.address,walletAddress:s.account,email:o.target.elements.email.value,giftName:(i=p==null?void 0:p.title)!=null?i:"",giftID:(c=p==null?void 0:p._id)!=null?c:"",tokenID:g};console.log("form ======================",t),x(!1),await w.post(`${n}/gift-request`,t).then(function(f){console.log("response=======",f),F(!0)}).catch(function(f){console.log(f),alert(f)})};a.exports.useEffect(()=>{g!=null&&x(!0)},[g]);const ne=async o=>{B(o)},ae=async o=>{w.get(`${n}/gift/byContractAddress/${d.address}`).then(t=>{const i=t.data;console.log("giftNfts===================",i);let c=!1;i.forEach((f,k)=>{console.log("tx ============= taolao",c),c==!1&&(console.log("transaction.contractName, transaction.tokenID =============",f.tokenID),c=!0,G(f))}),W(i),console.log("setGiftObjects======================",S)}).catch(t=>console.log(t))};return l(me,{children:[l("div",{children:[e(ge,{isOpen:H,onAfterOpen:K,onRequestClose:v,style:Y,contentLabel:"Example Modal",children:e("div",{className:"loader-container",children:e("div",{className:"spinner"})})}),l(we,{open:te,closeOnDocumentClick:!0,onClose:v,className:"popup-content",children:[l("div",{className:"modal-1",children:[e("a",{className:"close",onClick:v,style:{float:"right",fontWeight:"bold",fontSize:20},children:"\xD7"}),e("br",{}),l("div",{style:{width:420,margin:"auto",marginTop:10,paddingBottom:10,float:"left",marginLeft:30},className:"ant-list ant-list-split ant-list-bordered",children:[S.map((o,t)=>{var i;return l("div",{children:[" ",l("h1",{style:{float:"left",fontWeight:"bold",fontSize:15,margin:8},children:["Gift Name: ",(i=o==null?void 0:o.title)!=null?i:""]}),e("h3",{style:{float:"left",margin:8,fontSize:15}})," "]})}),e("hr",{style:{float:"left",width:420}}),e("h1",{style:{float:"left",fontWeight:"bold",margin:8,fontSize:20},children:"Fill info to receive gift"}),e("p",{style:{float:"left",width:720,height:1}}),l("form",{onSubmit:se,children:[l("div",{style:{margin:8},children:[e("span",{style:{margin:8,float:"left"},children:" Full Name: "}),e("input",{name:"name",type:"text",className:"ant-input ant-input-lg"})]}),l("div",{style:{margin:8},children:[e("span",{style:{margin:8,float:"left"},children:" Phone"}),e("input",{name:"phone",type:"text",className:"ant-input ant-input-lg"})]}),l("div",{style:{margin:8},children:[e("span",{style:{margin:8,float:"left"},children:" Email: "}),e("input",{name:"email",type:"text",className:"ant-input ant-input-lg"})]}),e("div",{children:e("span",{style:{marginRight:50,float:"right",width:100},children:e("button",{type:"submit",class:"ant-input ant-input-lg",children:" Submit"})})})]})]})]}),e("p",{style:{float:"left",width:720,height:20}})]})]}),e("div",{style:{width:720,margin:"auto",marginTop:32,float:"left",marginLeft:50},children:e("h1",{style:{float:"left",fontWeight:"bold",fontSize:30},children:"Nft Detail"})}),e("div",{style:{width:720,margin:"auto",marginTop:32,paddingBottom:32,float:"left",marginLeft:50},className:"ant-list ant-list-split ant-list-bordered",children:e(R,{bordered:!0,dataSource:V,renderItem:o=>{const t=o.id.toNumber(),i=o.image;return l(R.Item,{children:[l(ye,{title:l("div",{style:{float:"left",margin:8},children:[l("span",{style:{fontWeight:"bold"},children:["#",t]})," ",o.name]}),children:[e("div",{children:e("img",{src:i,style:{maxWidth:100}})}),l("div",{style:{float:"left",margin:8},children:[" ",e("span",{style:{fontWeight:"bold"},children:"Des: "}),o.description]}),l("div",{style:{float:"left",margin:8,textAlign:"left"},children:[" ",e("span",{style:{fontWeight:"bold"},children:"Contract Adress: "})," ",o.contract.address]})]}),l("div",{style:{float:"right",margin:8,textAlign:"left"},children:["Owner:",e(be,{address:o.owner,fontSize:16}),e(xe,{ensProvider:Q,placeholder:"Transfer to address",address:b[t],onChange:c=>{ee(A(C({},b),{[t]:c}))}}),e("br",{}),e(j,{style:{float:"right"},onClick:()=>{!s.account||!y||y(d.transferFrom(s.account,b[t],t),c=>{console.log("transfer==============",c)})},children:"Transfer"}),e("br",{}),e("br",{}),I?e(j,{style:{float:"right"},onClick:()=>{!s.account||!y||(console.log("onClaimGift===================",t),ne(t))},children:"Claim Gift"}):""]})]},t+"_"+o.uri+"_"+o.owner)}})})]})};export{Fe as NftDetail};
